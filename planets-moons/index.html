<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Planets, dwarf planets & moons of the Solar System</title>
    <link href="https://fonts.googleapis.com/css?family=Rajdhani" rel="stylesheet">
    <script src="https://d3js.org/d3.v5.min.js" charset="utf-8"></script>
    <style>

      body, #chart {
	  background: rgb(20, 20, 20);
      }

      .label, h1 {
	  font-family: Rajdhani;
	  fill: #fff;
      }

      .label {
	  font-size: 12px;
	  text-anchor: middle;
      }

      h1 {
	  font-size: 36px;
	  text-align: center;
	  width: 100%;
	  color: #fff;
	  margin-top: calc(2 * 36px);
      }
      
    </style>

</head>

<body>

  <h1>The planets, dwarf planets & moons<br>of the Solar System</h1>
  
<svg id="chart"></svg>

<script>
const height = 1800;
const columnWidth = 100;

d3.json('planets.json')
    .then((data) => { showChart(data.planets) });

function grey(value) {
    return `rgb(${Array(3).fill(value).join(',')})`;
}

function showChart(planets) {
    const fillColors = i => {
	return `rgb(${Array(3).fill(150 + i * 40).join(', ')})`;
    };
    
    const maxRadius = d3.max(planets.reduce((acc, curr) => {
      	acc.push(curr.diameter / 2);
      	return acc;
    }, []));
    const scale = d3.scaleLinear()
      	  .domain([0, maxRadius])
      	  .range([0, 110]);
    const chart = d3.select('#chart')
	  .attr('width', planets.length * columnWidth)
	  .attr('height', height);
    const planet = chart.selectAll('g')
	  .data(planets)
	  .enter().append('g')
	  .attr('class', 'planet')
	  .attr('transform', (_, i) => `translate(${i * columnWidth + 40}, 320)`);
    planet.append('circle')
	.attr('cy', _ => scale(maxRadius) - scale(_.diameter / 2) - 160)
	.attr('r', _ => scale(_.diameter / 2))
	.style('fill', (_, i) => fillColors(i % 3));
    planet.append('text')
	.attr('class', 'label')
	.attr('y', -20)
	.text(_ => _.name);
    planet.selectAll('g')
      	.data(_ => _.moons)
      	.enter().append('circle')
	.attr('cy', (_, i) => i * 10)
	.attr('r', (_, i) =>  (i % 10 === 0 && i > 0) ? 2 : 1)
	.style('fill', grey(200));
}
</script>

</body>

</html>
